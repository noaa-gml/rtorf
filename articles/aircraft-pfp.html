<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>aircraft-pfp â€¢ rtorf</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="aircraft-pfp">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtorf</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/aircore.html">aircore</a></li>
    <li><a class="dropdown-item" href="../articles/aircraft-flask.html">aircraft-flask</a></li>
    <li><a class="dropdown-item" href="../articles/aircraft-insitu.html">aircraft-insitu</a></li>
    <li><a class="dropdown-item" href="../articles/aircraft-pfp.html">aircraft-pfp</a></li>
    <li><a class="dropdown-item" href="../articles/hysplit.html">hysplit</a></li>
    <li><a class="dropdown-item" href="../articles/shipboard-flask.html">shipboard-flask</a></li>
    <li><a class="dropdown-item" href="../articles/shipoboard-insitu.html">shipboard-insitu</a></li>
    <li><a class="dropdown-item" href="../articles/summary.html">summary</a></li>
    <li><a class="dropdown-item" href="../articles/surface-flask.html">surface-flask</a></li>
    <li><a class="dropdown-item" href="../articles/surface-insitu.html">surface-insitu</a></li>
    <li><a class="dropdown-item" href="../articles/surface-pfp.html">surface-pfp</a></li>
    <li><a class="dropdown-item" href="../articles/tower-insitu.html">tower-insitu</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/noaa-gml/rtorf/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>aircraft-pfp</h1>
            
            <h4 data-toc-skip class="date">2025-04-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-gml/rtorf/blob/main/vignettes/aircraft-pfp.Rmd" class="external-link"><code>vignettes/aircraft-pfp.Rmd</code></a></small>
      <div class="d-none name"><code>aircraft-pfp.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/noaa-gml/rtorf" class="external-link">rtorf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cate</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aircraft-pfp"</span>,</span>
<span>         <span class="st">"aircraft-insitu"</span>,</span>
<span>         <span class="st">"aircraft-flask"</span>,</span>
<span>         <span class="st">"surface-insitu"</span>,</span>
<span>         <span class="st">"surface-flask"</span>, </span>
<span>         <span class="st">"surface-pfp"</span>,   </span>
<span>         <span class="st">"tower-insitu"</span>,  </span>
<span>         <span class="st">"aircore"</span>,       </span>
<span>         <span class="st">"shipboard-insitu"</span>,</span>
<span>         <span class="st">"shipboard-flask"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">obsch4</span> <span class="op">&lt;-</span> <span class="st">"Z:/obspack/obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08/data/nc/"</span></span>
<span><span class="va">indexch4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_summary.html">obs_summary</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="va">obsch4</span>, </span>
<span>                     categories <span class="op">=</span> <span class="va">cate</span><span class="op">)</span></span></code></pre></div>
<pre><code>Number of files of index: 479
              sector     N
              &lt;char&gt; &lt;int&gt;
 1:     aircraft-pfp    42
 2:  aircraft-insitu    17
 3:    surface-flask   106
 4:   surface-insitu   121
 5:   aircraft-flask     4
 6:          aircore     1
 7:      surface-pfp    33
 8:     tower-insitu   150
 9:  shipboard-flask     4
10: shipboard-insitu     1
11:    Total sectors   479
Detected 203 files with agl
Detected 276 files without agl</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obsco2</span> <span class="op">&lt;-</span> <span class="st">"Z:/obspack/obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08/data/nc/"</span></span>
<span><span class="va">indexco2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_summary.html">obs_summary</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="va">obsco2</span>, </span>
<span>                        categories <span class="op">=</span> <span class="va">cate</span><span class="op">)</span></span></code></pre></div>
<pre><code>Number of files of index: 617
              sector     N
              &lt;char&gt; &lt;int&gt;
1:   surface-insitu   160
2:     aircraft-pfp    41
3:  aircraft-insitu    41
4:    surface-flask   138
5: shipboard-insitu    14
6:   aircraft-flask     6
7:          aircore     1
8:      surface-pfp    29
9:     tower-insitu   183
10:  shipboard-flask     4
11:    Total sectors   617
Detected 231 files with agl
Detected 386 files without agl</code></pre>
<p>We can merge co2 and ch4</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">indexch4</span>,</span>
<span>               <span class="va">indexco2</span><span class="op">)</span></span></code></pre></div>
<p>Now we read the <code>aircraft-pfp</code> using the function
<code>obs_read_nc</code>. To this date, <code>solar_time</code> is not
included for aircraft, so we <code>FALSE</code> that argument.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datasetid</span> <span class="op">&lt;-</span> <span class="st">"aircraft-pfp"</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_read_nc.html">obs_read_nc</a></span><span class="op">(</span>index <span class="op">=</span> <span class="va">index</span>,</span>
<span>                  categories <span class="op">=</span> <span class="va">datasetid</span>,</span>
<span>                  solar_time <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                  verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<pre><code>Searching aircraft-pfp...
1: ch4_aao_aircraft-pfp_1_allvalid.nc
2: ch4_acg_aircraft-pfp_1_allvalid.nc
3: ch4_act_aircraft-pfp_1_allvalid-b200.nc
4: ch4_act_aircraft-pfp_1_allvalid-c130.nc
5: ch4_alf_aircraft-pfp_26_representative.nc
6: ch4_bgi_aircraft-pfp_1_allvalid.nc
7: ch4_bne_aircraft-pfp_1_allvalid.nc
8: ch4_car_aircraft-pfp_1_allvalid.nc
9: ch4_cma_aircraft-pfp_1_allvalid.nc
10: ch4_crv_aircraft-pfp_1_allvalid.nc
11: ch4_dnd_aircraft-pfp_1_allvalid.nc
12: ch4_esp_aircraft-pfp_1_allvalid.nc
13: ch4_etl_aircraft-pfp_1_allvalid.nc
14: ch4_ftl_aircraft-pfp_1_allvalid.nc
15: ch4_fwi_aircraft-pfp_1_allvalid.nc
16: ch4_haa_aircraft-pfp_1_allvalid.nc
17: ch4_hfm_aircraft-pfp_1_allvalid.nc
18: ch4_hil_aircraft-pfp_1_allvalid.nc
19: ch4_hip_aircraft-pfp_1_allvalid.nc
20: ch4_inx_aircraft-pfp_1_allvalid.nc
21: ch4_lef_aircraft-pfp_1_allvalid.nc
22: ch4_man_aircraft-pfp_26_representative.nc
23: ch4_mci_aircraft-pfp_1_allvalid.nc
24: ch4_mrc_aircraft-pfp_1_allvalid.nc
25: ch4_nha_aircraft-pfp_1_allvalid.nc
26: ch4_oil_aircraft-pfp_1_allvalid.nc
27: ch4_pfa_aircraft-pfp_1_allvalid.nc
28: ch4_rba-b_aircraft-pfp_26_representative.nc
29: ch4_rta_aircraft-pfp_1_allvalid.nc
30: ch4_sah_aircraft-pfp_26_representative.nc
31: ch4_sam_aircraft-pfp_1_allvalid.nc
32: ch4_san_aircraft-pfp_1_allvalid.nc
33: ch4_san_aircraft-pfp_26_representative.nc
34: ch4_sca_aircraft-pfp_1_allvalid.nc
35: ch4_sgp_aircraft-pfp_1_allvalid.nc
36: ch4_tab_aircraft-pfp_26_representative.nc
37: ch4_tgc_aircraft-pfp_1_allvalid.nc
38: ch4_thd_aircraft-pfp_1_allvalid.nc
39: ch4_ulb_aircraft-pfp_1_allvalid.nc
40: ch4_wbi_aircraft-pfp_1_allvalid.nc
41: co2_aao_aircraft-pfp_1_allvalid.nc
42: co2_above_aircraft-pfp_1_allvalid.nc
43: co2_acg_aircraft-pfp_1_allvalid.nc
44: co2_act_aircraft-pfp_1_allvalid-b200.nc
45: co2_act_aircraft-pfp_1_allvalid-c130.nc
46: co2_alf_aircraft-pfp_433_representative.nc
47: co2_bgi_aircraft-pfp_1_allvalid.nc
48: co2_bne_aircraft-pfp_1_allvalid.nc
49: co2_car_aircraft-pfp_1_allvalid.nc
50: co2_cma_aircraft-pfp_1_allvalid.nc
51: co2_cob_aircraft-pfp_1_allvalid.nc
52: co2_crv_aircraft-pfp_1_allvalid.nc
53: co2_dnd_aircraft-pfp_1_allvalid.nc
54: co2_esp_aircraft-pfp_1_allvalid.nc
55: co2_etl_aircraft-pfp_1_allvalid.nc
56: co2_ftl_aircraft-pfp_1_allvalid.nc
57: co2_fwi_aircraft-pfp_1_allvalid.nc
58: co2_haa_aircraft-pfp_1_allvalid.nc
59: co2_hfm_aircraft-pfp_1_allvalid.nc
60: co2_hil_aircraft-pfp_1_allvalid.nc
61: co2_inx_aircraft-pfp_1_allvalid.nc
62: co2_lef_aircraft-pfp_1_allvalid.nc
63: co2_mci_aircraft-pfp_1_allvalid.nc
64: co2_mrc_aircraft-pfp_1_allvalid.nc
65: co2_nha_aircraft-pfp_1_allvalid.nc
66: co2_oil_aircraft-pfp_1_allvalid.nc
67: co2_pan_aircraft-pfp_433_representative.nc
68: co2_pfa_aircraft-pfp_1_allvalid.nc
69: co2_rba-b_aircraft-pfp_433_representative.nc
70: co2_rta_aircraft-pfp_1_allvalid.nc
71: co2_sam_aircraft-pfp_1_allvalid.nc
72: co2_san_aircraft-pfp_1_allvalid.nc
73: co2_san_aircraft-pfp_433_representative.nc
74: co2_sca_aircraft-pfp_1_allvalid.nc
75: co2_sgp_aircraft-pfp_1_allvalid.nc
76: co2_tab_aircraft-pfp_433_representative.nc
77: co2_tef_aircraft-pfp_433_representative.nc
78: co2_tgc_aircraft-pfp_1_allvalid.nc
79: co2_thd_aircraft-pfp_1_allvalid.nc
80: co2_ulb_aircraft-pfp_1_allvalid.nc
81: co2_wbi_aircraft-pfp_1_allvalid.nc</code></pre>
<p>Now we check the data</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span></span></code></pre></div>
<pre><code>         year month   day  hour minute second       time start_time midpoint_time
        &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt;      &lt;int&gt;      &lt;int&gt;         &lt;int&gt;
     1:  2006     6     7    22     11     47 1149718307 1149718307    1149718307
     2:  2006     6     7    22     28     22 1149719302 1149719302    1149719302
     3:  2006     6     7    22     41     24 1149720084 1149720084    1149720084
     4:  2006     6     7    22     55     31 1149720931 1149720931    1149720931
     5:  2006     6     7    23     22     23 1149722543 1149722543    1149722543
    ---                                                                          
176349:  2022    12    21    19     12     27 1671649947 1671649947    1671649947
176350:  2022    12    21    19     15      1 1671650101 1671650101    1671650101
176351:  2022    12    21    19     17     32 1671650252 1671650252    1671650252
176352:  2022    12    21    19     19     55 1671650395 1671650395    1671650395
176353:  2022    12    21    19     23      3 1671650583 1671650583    1671650583
                    datetime time_decimal time_interval       value value_unc nvalue
                      &lt;char&gt;        &lt;num&gt;         &lt;int&gt;       &lt;num&gt;     &lt;num&gt;  &lt;int&gt;
     1: 2006-06-07T22:11:47Z     2006.433          3600 1.81998e-06   1.7e-09      1
     2: 2006-06-07T22:28:22Z     2006.433          3600 1.81748e-06   1.7e-09      1
     3: 2006-06-07T22:41:24Z     2006.433          3600 1.83108e-06   1.7e-09      1
     4: 2006-06-07T22:55:31Z     2006.433          3600 1.83283e-06   1.7e-09      1
     5: 2006-06-07T23:22:23Z     2006.433          3600 1.84134e-06   1.7e-09      1
    ---                                                                             
176349: 2022-12-21T19:12:27Z     2022.972          3600 4.22600e-04   4.1e-08      1
176350: 2022-12-21T19:15:01Z     2022.972          3600 4.22920e-04   4.1e-08      1
176351: 2022-12-21T19:17:32Z     2022.972          3600 4.22120e-04   4.1e-08      1
176352: 2022-12-21T19:19:55Z     2022.972          3600 4.28270e-04   4.1e-08      1
176353: 2022-12-21T19:23:03Z     2022.972          3600 4.27920e-04   4.1e-08      1
        value_std_dev latitude longitude altitude elevation intake_height qcflag
                &lt;num&gt;    &lt;num&gt;     &lt;num&gt;    &lt;num&gt;     &lt;num&gt;         &lt;num&gt; &lt;char&gt;
     1:            NA  40.1000  -88.5500  4758.10       210       4548.10    ...
     2:            NA  40.1000  -88.5500  3801.47       210       3591.47    ...
     3:            NA  40.1000  -88.5500  3170.38       210       2960.38    ...
     4:            NA  40.1000  -88.5500  2539.71       210       2329.71    ...
     5:            NA  40.1000  -88.5500  1905.77       210       1695.77    ...
    ---                                                                         
176349:            NA  41.7190  -91.5463  3008.99       227       2781.99    ...
176350:            NA  41.6885  -91.5333  2387.80       240       2147.80    ...
176351:            NA  41.6865  -91.3657  1763.88       230       1533.88    ...
176352:            NA  41.6935  -91.2090  1124.71       247        877.71    ...
176353:            NA  41.7063  -91.0566   950.98       219        731.98    ...
        instrument   analysis_datetime method event_number air_sample_container_id
            &lt;char&gt;              &lt;char&gt; &lt;char&gt;       &lt;char&gt;                  &lt;char&gt;
     1:         H4 2006-06-16T17:06:00      A       218410                 3141-01
     2:         H4 2006-06-16T17:21:00      A       218411                 3141-02
     3:         H4 2006-06-16T17:36:00      A       218412                 3141-03
     4:         H4 2006-06-16T17:51:00      A       218413                 3141-04
     5:         H4 2006-06-16T18:20:00      A       218415                 3141-06
    ---                                                                           
176349:        PC2 2023-01-03T22:20:27      R       512757                 3036-08
176350:        PC2 2023-01-03T22:35:42      R       512758                 3036-09
176351:        PC2 2023-01-03T22:50:56      R       512759                 3036-10
176352:        PC2 2023-01-03T23:06:10      R       512760                 3036-11
176353:        PC2 2023-01-03T23:21:24      R       512761                 3036-12
        obs_flag obspack_num
           &lt;int&gt;       &lt;int&gt;
     1:        1      959079
     2:        1      959080
     3:        1      959081
     4:        1      959082
     5:        1      959083
    ---                     
176349:        1     1827113
176350:        1     1827114
176351:        1     1827115
176352:        1     1827116
176353:        1     1827117
                                                                                  obspack_id
                                                                                      &lt;char&gt;
     1:  obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08~ch4_aao_aircraft-pfp_1_allvalid~959079
     2:  obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08~ch4_aao_aircraft-pfp_1_allvalid~959080
     3:  obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08~ch4_aao_aircraft-pfp_1_allvalid~959081
     4:  obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08~ch4_aao_aircraft-pfp_1_allvalid~959082
     5:  obspack_ch4_1_GLOBALVIEWplus_v5.1_2023-03-08~ch4_aao_aircraft-pfp_1_allvalid~959083
    ---                                                                                     
176349: obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08~co2_wbi_aircraft-pfp_1_allvalid~1827113
176350: obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08~co2_wbi_aircraft-pfp_1_allvalid~1827114
176351: obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08~co2_wbi_aircraft-pfp_1_allvalid~1827115
176352: obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08~co2_wbi_aircraft-pfp_1_allvalid~1827116
176353: obspack_co2_1_GLOBALVIEWplus_v9.1_2023-12-08~co2_wbi_aircraft-pfp_1_allvalid~1827117
        unique_sample_location_num          scale site_elevation_unit dataset_project
                             &lt;int&gt;         &lt;char&gt;              &lt;char&gt;          &lt;char&gt;
     1:                    2718218 WMO CH4 X2004A                masl    aircraft-pfp
     2:                    2718192 WMO CH4 X2004A                masl    aircraft-pfp
     3:                    2718174 WMO CH4 X2004A                masl    aircraft-pfp
     4:                    2718138 WMO CH4 X2004A                masl    aircraft-pfp
     5:                    2718094 WMO CH4 X2004A                masl    aircraft-pfp
    ---                                                                              
176349:                   55771244  WMO CO2 X2019                masl    aircraft-pfp
176350:                   55771219  WMO CO2 X2019                masl    aircraft-pfp
176351:                   55771217  WMO CO2 X2019                masl    aircraft-pfp
176352:                   55771222  WMO CO2 X2019                masl    aircraft-pfp
176353:                   55771235  WMO CO2 X2019                masl    aircraft-pfp
        dataset_selection_tag                                         site_name
                       &lt;char&gt;                                            &lt;char&gt;
     1:              allvalid Airborne Aerosol Observatory, Bondville, Illinois
     2:              allvalid Airborne Aerosol Observatory, Bondville, Illinois
     3:              allvalid Airborne Aerosol Observatory, Bondville, Illinois
     4:              allvalid Airborne Aerosol Observatory, Bondville, Illinois
     5:              allvalid Airborne Aerosol Observatory, Bondville, Illinois
    ---                                                                        
176349:              allvalid                                 West Branch, Iowa
176350:              allvalid                                 West Branch, Iowa
176351:              allvalid                                 West Branch, Iowa
176352:              allvalid                                 West Branch, Iowa
176353:              allvalid                                 West Branch, Iowa
        site_elevation site_latitude site_longitude  site_country site_code site_utc2lst
                 &lt;num&gt;         &lt;num&gt;          &lt;num&gt;        &lt;char&gt;    &lt;char&gt;        &lt;num&gt;
     1:          230.0       40.0500       -88.3700 United States       AAO           -6
     2:          230.0       40.0500       -88.3700 United States       AAO           -6
     3:          230.0       40.0500       -88.3700 United States       AAO           -6
     4:          230.0       40.0500       -88.3700 United States       AAO           -6
     5:          230.0       40.0500       -88.3700 United States       AAO           -6
    ---                                                                                 
176349:          241.7       41.7248       -91.3529 United States       WBI           -6
176350:          241.7       41.7248       -91.3529 United States       WBI           -6
176351:          241.7       41.7248       -91.3529 United States       WBI           -6
176352:          241.7       41.7248       -91.3529 United States       WBI           -6
176353:          241.7       41.7248       -91.3529 United States       WBI           -6
        lab_1_abbr dataset_calibration_scale altitude_final type_altitude air_flag
            &lt;char&gt;                    &lt;char&gt;          &lt;num&gt;         &lt;num&gt;    &lt;int&gt;
     1:       NOAA            WMO CH4 X2004A        4758.10             1       NA
     2:       NOAA            WMO CH4 X2004A        3801.47             1       NA
     3:       NOAA            WMO CH4 X2004A        3170.38             1       NA
     4:       NOAA            WMO CH4 X2004A        2539.71             1       NA
     5:       NOAA            WMO CH4 X2004A        1905.77             1       NA
    ---                                                                           
176349:       NOAA             WMO CO2 X2019        3008.99             1       NA
176350:       NOAA             WMO CO2 X2019        2387.80             1       NA
176351:       NOAA             WMO CO2 X2019        1763.88             1       NA
176352:       NOAA             WMO CO2 X2019        1124.71             1       NA
176353:       NOAA             WMO CO2 X2019         950.98             1       NA
        bl_bt_flag CT_assim CT_may_localize CT_may_reject       CT_MDM      CT_RMSE
             &lt;int&gt;    &lt;int&gt;           &lt;int&gt;         &lt;int&gt;        &lt;num&gt;        &lt;num&gt;
     1:         NA       NA              NA            NA           NA           NA
     2:         NA       NA              NA            NA           NA           NA
     3:         NA       NA              NA            NA           NA           NA
     4:         NA       NA              NA            NA           NA           NA
     5:         NA       NA              NA            NA           NA           NA
    ---                                                                            
176349:         NA        1               1             1 7.204303e-07 7.583477e-07
176350:         NA        1               1             1 9.783121e-07 1.029802e-06
176351:         NA        1               1             1 1.614815e-06 1.699805e-06
176352:         NA        1               1             1 1.614815e-06 1.699805e-06
176353:         NA        1               1             1 2.754005e-06 2.898953e-06
        CT_sampling_strategy flight_flag flight_id gps_altitude   h2o maneuver_flag
                       &lt;int&gt;       &lt;int&gt;    &lt;char&gt;        &lt;num&gt; &lt;num&gt;         &lt;int&gt;
     1:                   NA          NA      &lt;NA&gt;           NA    NA            NA
     2:                   NA          NA      &lt;NA&gt;           NA    NA            NA
     3:                   NA          NA      &lt;NA&gt;           NA    NA            NA
     4:                   NA          NA      &lt;NA&gt;           NA    NA            NA
     5:                   NA          NA      &lt;NA&gt;           NA    NA            NA
    ---                                                                            
176349:                    2          NA      &lt;NA&gt;           NA    NA            NA
176350:                    2          NA      &lt;NA&gt;           NA    NA            NA
176351:                    2          NA      &lt;NA&gt;           NA    NA            NA
176352:                    2          NA      &lt;NA&gt;           NA    NA            NA
176353:                    2          NA      &lt;NA&gt;           NA    NA            NA
        maneuver_flagqc pressure pressure_altitude profile_id source_id temperature     u
                  &lt;int&gt;    &lt;num&gt;             &lt;num&gt;     &lt;char&gt;    &lt;char&gt;       &lt;num&gt; &lt;num&gt;
     1:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
     2:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
     3:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
     4:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
     5:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
    ---                                                                                  
176349:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
176350:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
176351:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
176352:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
176353:              NA       NA                NA       &lt;NA&gt;      &lt;NA&gt;          NA    NA
            v value_original_scale
        &lt;num&gt;                &lt;num&gt;
     1:    NA                   NA
     2:    NA                   NA
     3:    NA                   NA
     4:    NA                   NA
     5:    NA                   NA
    ---                           
176349:    NA                   NA
176350:    NA                   NA
176351:    NA                   NA
176352:    NA                   NA
176353:    NA                   NA</code></pre>
<p>Now we can process the data. We first filter for observations within
our spatial domain:</p>
<div class="section level2">
<h2 id="checks-and-definitions">Checks and definitions<a class="anchor" aria-label="anchor" href="#checks-and-definitions"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">north</span> <span class="op">&lt;-</span> <span class="fl">80</span></span>
<span><span class="va">south</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span><span class="va">west</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">170</span></span>
<span><span class="va">east</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">50</span></span>
<span><span class="va">max_altitude</span> <span class="op">&lt;-</span> <span class="fl">8000</span></span>
<span><span class="va">yy</span> <span class="op">&lt;-</span> <span class="fl">2020</span></span></code></pre></div>
<p>We check altitude, intake_height, altitude_final and elevation.
altitude_final is a column from intake_height, added to match column
from obs_read text files.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"altitude"</span>, <span class="st">"altitude_final"</span>, <span class="st">"intake_height"</span>, <span class="st">"elevation"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>        altitude altitude_final intake_height elevation
           &lt;num&gt;          &lt;num&gt;         &lt;num&gt;     &lt;num&gt;
     1:  4758.10        4758.10       4548.10       210
     2:  3801.47        3801.47       3591.47       210
     3:  3170.38        3170.38       2960.38       210
     4:  2539.71        2539.71       2329.71       210
     5:  1905.77        1905.77       1695.77       210
    ---                                                
176349:  3008.99        3008.99       2781.99       227
176350:  2387.80        2387.80       2147.80       240
176351:  1763.88        1763.88       1533.88       230
176352:  1124.71        1124.71        877.71       247
176353:   950.98         950.98        731.98       219</code></pre>
<p>The temporal range of data is</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 1992 2021</code></pre>
<p>We also check for dimensions of data</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 176353     68</code></pre>
</div>
<div class="section level2">
<h2 id="filters">Filters<a class="anchor" aria-label="anchor" href="#filters"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">year</span> <span class="op">==</span> <span class="va">yy</span><span class="op">]</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">altitude_final</span> <span class="op">&lt;</span> <span class="va">max_altitude</span> <span class="op">&amp;</span></span>
<span>           <span class="va">latitude</span> <span class="op">&lt;</span> <span class="va">north</span> <span class="op">&amp;</span></span>
<span>           <span class="va">latitude</span> <span class="op">&gt;</span> <span class="va">south</span> <span class="op">&amp;</span></span>
<span>           <span class="va">longitude</span> <span class="op">&lt;</span> <span class="va">east</span> <span class="op">&amp;</span></span>
<span>           <span class="va">longitude</span> <span class="op">&gt;</span> <span class="va">west</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 5615   68</code></pre>
</div>
<div class="section level2">
<h2 id="adding-time-as-posixct-class">Adding time as POSIXct class<a class="anchor" aria-label="anchor" href="#adding-time-as-posixct-class"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_addtime.html">obs_addtime</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="st">"timeUTC"</span><span class="op">]</span></span></code></pre></div>
<pre><code>                  timeUTC
                   &lt;POSc&gt;
   1: 2020-01-02 19:50:20
   2: 2020-01-02 19:59:18
   3: 2020-01-02 20:08:11
   4: 2020-01-02 20:16:34
   5: 2020-01-02 20:23:47
  ---                    
5611: 2020-12-28 20:21:43
5612: 2020-12-28 20:23:59
5613: 2020-12-28 20:26:07
5614: 2020-12-28 20:28:09
5615: 2020-12-28 20:30:23</code></pre>
</div>
<div class="section level2">
<h2 id="cut-time">Cut time<a class="anchor" aria-label="anchor" href="#cut-time"></a>
</h2>
<p>now we can cut time every 20 seconds. We can chosse other frequency
as well.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">sec2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_freq.html">obs_freq</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">second</span>,</span>
<span>                     freq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">59</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"second"</span>, <span class="st">"sec2"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>      second  sec2
       &lt;int&gt; &lt;num&gt;
   1:     20     0
   2:     18     0
   3:     11     0
   4:     34    20
   5:     47    40
  ---             
5611:     43    40
5612:     59    40
5613:      7     0
5614:      9     0
5615:     23    20</code></pre>
</div>
<div class="section level2">
<h2 id="aggregate-data">Aggregate data<a class="anchor" aria-label="anchor" href="#aggregate-data"></a>
</h2>
<p>now we need to add the column key_time, that it will be used to
aggregate other variables</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">key_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ISOdatetime.html" class="external-link">ISOdatetime</a></span><span class="op">(</span>year <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">year</span>,</span>
<span>                           month <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">month</span>,</span>
<span>                           day <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">day</span>,</span>
<span>                           hour <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">hour</span>,</span>
<span>                           min <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">minute</span>,</span>
<span>                           sec <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">sec2</span>,</span>
<span>                           tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"timeUTC"</span>, <span class="st">"key_time"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>                  timeUTC            key_time
                   &lt;POSc&gt;              &lt;POSc&gt;
   1: 2020-01-02 19:50:20 2020-01-02 19:50:00
   2: 2020-01-02 19:59:18 2020-01-02 19:59:00
   3: 2020-01-02 20:08:11 2020-01-02 20:08:00
   4: 2020-01-02 20:16:34 2020-01-02 20:16:20
   5: 2020-01-02 20:23:47 2020-01-02 20:23:40
  ---                                        
5611: 2020-12-28 20:21:43 2020-12-28 20:21:40
5612: 2020-12-28 20:23:59 2020-12-28 20:23:40
5613: 2020-12-28 20:26:07 2020-12-28 20:26:00
5614: 2020-12-28 20:28:09 2020-12-28 20:28:00
5615: 2020-12-28 20:30:23 2020-12-28 20:30:20</code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_agg.html">obs_agg</a></span><span class="op">(</span><span class="va">df</span>, cols <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"year"</span>,</span>
<span>                             <span class="st">"month"</span>,</span>
<span>                             <span class="st">"day"</span>,</span>
<span>                             <span class="st">"hour"</span>,</span>
<span>                             <span class="st">"minute"</span>,</span>
<span>                             <span class="st">"second"</span>,</span>
<span>                             <span class="st">"time"</span>,</span>
<span>                             <span class="st">"time_decimal"</span>,</span>
<span>                             <span class="st">"value"</span>,</span>
<span>                             <span class="st">"latitude"</span>,</span>
<span>                             <span class="st">"longitude"</span>,</span>
<span>                             <span class="st">"altitude_final"</span>,</span>
<span>                             <span class="st">"elevation"</span>,</span>
<span>                             <span class="st">"intake_height"</span>,</span>
<span>                             <span class="st">"gps_altitude"</span>,</span>
<span>                             <span class="st">"pressure"</span>,</span>
<span>                             <span class="st">"pressure_altitude"</span>,</span>
<span>                             <span class="st">"u"</span>, <span class="st">"v"</span>, <span class="st">"temperature"</span>,</span>
<span>                             <span class="st">"type_altitude"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>Processed 5615 groups out of 5615. 100% done. Time elapsed: 4s. ETA: 0s.
Adding time</code></pre>
</div>
<div class="section level2">
<h2 id="add-local-time">Add local time<a class="anchor" aria-label="anchor" href="#add-local-time"></a>
</h2>
<p>Now we add local time</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_addltime.html">obs_addltime</a></span><span class="op">(</span><span class="va">df2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/setorder.html" class="external-link">setorderv</a></span><span class="op">(</span><span class="va">df3</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site_code"</span>, <span class="st">"timeUTC"</span>, <span class="st">"dataset_calibration_scale"</span><span class="op">)</span>,</span>
<span>          order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df3</span></span></code></pre></div>
<pre><code>                 key_time site_code altitude_final type_altitude lab_1_abbr
                   &lt;POSc&gt;    &lt;char&gt;          &lt;num&gt;         &lt;num&gt;     &lt;char&gt;
   1: 2020-01-14 18:28:20       WBI        7618.48             1       NOAA
   2: 2020-01-14 18:33:00       WBI        6958.89             1       NOAA
   3: 2020-01-14 18:37:40       WBI        5685.43             1       NOAA
   4: 2020-01-14 18:40:40       WBI        4987.14             1       NOAA
   5: 2020-01-14 18:43:20       WBI        4333.95             1       NOAA
  ---                                                                      
5611: 2020-12-25 21:09:20       CAR        2926.69             1       NOAA
5612: 2020-12-25 21:20:20       CAR        2453.94             1       NOAA
5613: 2020-12-25 21:27:20       CAR        2138.78             1       NOAA
5614: 2020-12-25 21:33:00       CAR        1832.76             1       NOAA
5615: 2020-12-25 21:35:40       CAR        1668.78             1       NOAA
      dataset_calibration_scale  year month    day  hour minute second       time
                         &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;char&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt;      &lt;num&gt;
   1:            WMO CH4 X2004A  2020     1     14    18     28     20 1579026500
   2:            WMO CH4 X2004A  2020     1     14    18     33      0 1579026780
   3:            WMO CH4 X2004A  2020     1     14    18     37     40 1579027060
   4:            WMO CH4 X2004A  2020     1     14    18     40     40 1579027240
   5:            WMO CH4 X2004A  2020     1     14    18     43     20 1579027400
  ---                                                                            
5611:             WMO CO2 X2019  2020    12     25    21      9     20 1608930560
5612:             WMO CO2 X2019  2020    12     25    21     20     20 1608931220
5613:             WMO CO2 X2019  2020    12     25    21     27     20 1608931640
5614:             WMO CO2 X2019  2020    12     25    21     33      0 1608931980
5615:             WMO CO2 X2019  2020    12     25    21     35     40 1608932140
      time_decimal       value latitude longitude altitude_final elevation intake_height
             &lt;num&gt;       &lt;num&gt;    &lt;num&gt;     &lt;num&gt;          &lt;num&gt;     &lt;num&gt;         &lt;num&gt;
   1:     2020.038 1.91295e-06  41.7505  -91.0213        7618.48       242       7376.48
   2:     2020.038 1.92525e-06  41.7427  -91.1791        6958.89       234       6724.89
   3:     2020.038 1.92408e-06  41.7232  -91.3675        5685.43       236       5449.43
   4:     2020.038 1.91808e-06  41.7275  -91.4877        4987.14       244       4743.14
   5:     2020.038 1.92311e-06  41.7177  -91.5966        4333.95       235       4098.95
  ---                                                                                   
5611:     2020.983 4.16040e-04  40.7275 -104.6853        2926.69      1559       1367.69
5612:     2020.983 4.16090e-04  40.7813 -104.6506        2453.94      1590        863.94
5613:     2020.983 4.15690e-04  40.7955 -104.6787        2138.78      1599        539.78
5614:     2020.983 4.15970e-04  40.6879 -104.6850        1832.76      1543        289.76
5615:     2020.983 4.18430e-04  40.7908 -104.6855        1668.78      1614         54.78
      gps_altitude pressure pressure_altitude     u     v temperature type_altitude
             &lt;num&gt;    &lt;num&gt;             &lt;num&gt; &lt;num&gt; &lt;num&gt;       &lt;num&gt;         &lt;num&gt;
   1:          NaN      NaN               NaN   NaN   NaN         NaN             1
   2:          NaN      NaN               NaN   NaN   NaN         NaN             1
   3:          NaN      NaN               NaN   NaN   NaN         NaN             1
   4:          NaN      NaN               NaN   NaN   NaN         NaN             1
   5:          NaN      NaN               NaN   NaN   NaN         NaN             1
  ---                                                                              
5611:          NaN      NaN               NaN   NaN   NaN         NaN             1
5612:          NaN      NaN               NaN   NaN   NaN         NaN             1
5613:          NaN      NaN               NaN   NaN   NaN         NaN             1
5614:          NaN      NaN               NaN   NaN   NaN         NaN             1
5615:          NaN      NaN               NaN   NaN   NaN         NaN             1
                  timeUTC          local_time    lh
                   &lt;POSc&gt;              &lt;POSc&gt; &lt;int&gt;
   1: 2020-01-14 18:28:20 2020-01-14 12:24:14    12
   2: 2020-01-14 18:33:00 2020-01-14 12:28:17    12
   3: 2020-01-14 18:37:40 2020-01-14 12:32:11    12
   4: 2020-01-14 18:40:40 2020-01-14 12:34:42    12
   5: 2020-01-14 18:43:20 2020-01-14 12:36:56    12
  ---                                              
5611: 2020-12-25 21:09:20 2020-12-25 14:10:35    14
5612: 2020-12-25 21:20:20 2020-12-25 14:21:43    14
5613: 2020-12-25 21:27:20 2020-12-25 14:28:37    14
5614: 2020-12-25 21:33:00 2020-12-25 14:34:15    14
5615: 2020-12-25 21:35:40 2020-12-25 14:36:55    14</code></pre>
</div>
<div class="section level2">
<h2 id="master">Master<a class="anchor" aria-label="anchor" href="#master"></a>
</h2>
<p>Before generating the receptors list, we have the databe with all the
required information</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">master</span> <span class="op">&lt;-</span> <span class="va">df3</span></span></code></pre></div>
<p>We may replace missing values with a nine nines. Here is
commented</p>
<p>#master[is.na(master)] &lt;- 999999999</p>
<p>We transform the time variables to character and round coordinates
with 4 digits</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">master</span><span class="op">$</span><span class="va">timeUTC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">master</span><span class="op">$</span><span class="va">timeUTC</span><span class="op">)</span></span>
<span><span class="va">master</span><span class="op">$</span><span class="va">local_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">master</span><span class="op">$</span><span class="va">local_time</span><span class="op">)</span></span>
<span><span class="va">master</span><span class="op">$</span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">master</span><span class="op">$</span><span class="va">latitude</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">master</span><span class="op">$</span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">master</span><span class="op">$</span><span class="va">longitude</span>, <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="save-master">Save master<a class="anchor" aria-label="anchor" href="#save-master"></a>
</h2>
<p>Finally we save the master file</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="txt">txt<a class="anchor" aria-label="anchor" href="#txt"></a>
</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".txt\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">master</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".txt"</span><span class="op">)</span>,</span>
<span>       sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span></code></pre></div>
<pre><code>C:\Users\sibarrae\AppData\Local\Temp\RtmpAj3Z3p\file7f9c18b239ca_aircraft-pfp.txt</code></pre>
</div>
<div class="section level3">
<h3 id="csv">csv<a class="anchor" aria-label="anchor" href="#csv"></a>
</h3>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".csv\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span><span class="va">master</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".csv"</span><span class="op">)</span>,</span>
<span>       sep <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span></code></pre></div>
<pre><code>C:\Users\sibarrae\AppData\Local\Temp\RtmpAj3Z3p\file7f9c18b239ca_aircraft-pfp.csv</code></pre>
</div>
<div class="section level3">
<h3 id="csvy">csvy<a class="anchor" aria-label="anchor" href="#csvy"></a>
</h3>
<p>CSVY are csv files with a YAML header to include metadata in
tabulated text files</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nAdding notes in csvy:\n"</span><span class="op">)</span></span>
<span><span class="va">notes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sector: "</span>, <span class="va">datasetid</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"timespan: "</span>, <span class="va">yy</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"spatial_limits: north = "</span>, <span class="va">north</span>, <span class="st">", south = "</span>, <span class="va">south</span>, <span class="st">", east = "</span>, <span class="va">east</span>, <span class="st">", west = "</span>, <span class="va">west</span><span class="op">)</span>,</span>
<span>           <span class="st">"gas: CO2 and CH4"</span>,</span>
<span>           <span class="st">"data: Data averaged every 20 seconds"</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"altitude: &lt; "</span>, <span class="va">max_altitude</span><span class="op">)</span>,</span>
<span>           <span class="st">"hours: All"</span>,</span>
<span>           <span class="st">"local_time: if var `site_utc2lst` is not available, calculated as"</span>,</span>
<span>           <span class="st">"longitude/15*60*60 (John Miller)"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">notes</span>, sep <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".csvy\n"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/obs_write_csvy.html">obs_write_csvy</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">master</span>,</span>
<span>               notes <span class="op">=</span> <span class="va">notes</span>,</span>
<span>               out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".csvy"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>sector: aircraft-pfp
timespan: 2020
spatial_limits: north = 80, south = 10, east = -50, west = -170
gas: CO2 and CH4
data: Data averaged every 20 seconds
altitude: &lt; 8000
C:\Users\sibarrae\AppData\Local\Temp\RtmpAj3Z3p\file7f9c18b239ca_aircraft-pfp.csvy
</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/obs_read_csvy.html">obs_read_csvy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>,<span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">".csvy"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "---"                                                                
 [2] "name: Metadata "                                                    
 [3] "sector: aircraft-pfp"                                               
 [4] "timespan: 2020"                                                     
 [5] "spatial_limits: north = 80, south = 10, east = -50, west = -170"    
 [6] "gas: CO2 and CH4"                                                   
 [7] "data: Data averaged every 20 seconds"                               
 [8] "altitude: &lt; 8000"                                                   
 [9] "structure: "                                                        
[10] "Classes â€˜data.tableâ€™ and 'data.frame':\t5615 obs. of  30 variables:"
[11] " $ key_time                 : POSIXct, format: \"2020-01-1\".."     
[12] " $ site_code                : chr  \"WBI\" \"WBI\" ..."             
[13] " $ altitude_final           : num  7618 7618 ..."                   
[14] " $ type_altitude            : num  1 1 1 1 1 ..."                   
[15] " $ lab_1_abbr               : chr  \"NOAA\" \"NOAA\" ..."           
[16] " $ dataset_calibration_scale: chr  \"WMO CH4 X2004A\" \"WMO \".."   
[17] " $ year                     : int  2020 2020 2020 2020 202.."       
[18] " $ month                    : int  1 1 1 1 1 ..."                   
[19] " $ day                      : chr  \"14\" \"14\" ..."               
[20] " $ hour                     : int  18 18 18 18 18 ..."              
[21] " $ minute                   : int  28 28 33 33 37 ..."              
[22] " $ second                   : int  20 20 0 0 40 ..."                
[23] " $ time                     : num  1.58e+09 1.58e+09 ..."           
[24] " $ time_decimal             : num  2020 2020 ..."                   
[25] " $ value                    : num  1.91e-06 4.14e-04 ..."           
[26] " $ latitude                 : num  41.8 41.8 ..."                   
[27] " $ longitude                : num  -91 -91 ..."                     
[28] " $ altitude_final           : num  7618 7618 ..."                   
[29] " $ elevation                : num  242 242 234 234 236 ..."         
[30] " $ intake_height            : num  7376 7376 ..."                   
[31] " $ gps_altitude             : num  NaN NaN NaN NaN NaN ..."         
[32] " $ pressure                 : num  NaN NaN NaN NaN NaN ..."         
[33] " $ pressure_altitude        : num  NaN NaN NaN NaN NaN ..."         
[34] " $ u                        : num  NaN NaN NaN NaN NaN ..."         
[35] " $ v                        : num  NaN NaN NaN NaN NaN ..."         
[36] " $ temperature              : num  NaN NaN NaN NaN NaN ..."         
[37] " $ type_altitude            : num  1 1 1 1 1 ..."                   
[38] " $ timeUTC                  : chr  \"2020-01-14 18:28:20\" \".."    
[39] " $ local_time               : chr  \"2020-01-14 12:24:14.8\".."     
[40] " $ lh                       : int  12 12 12 12 12 ..."              
[41] " - attr(*, \".internal.selfref\")=&lt;externalptr&gt; "                   
[42] "NULL"                                                               
[43] "---"                                                                
                 key_time site_code altitude_final type_altitude lab_1_abbr
                   &lt;POSc&gt;    &lt;char&gt;          &lt;num&gt;         &lt;int&gt;     &lt;char&gt;
   1: 2020-01-14 18:28:20       WBI        7618.48             1       NOAA
   2: 2020-01-14 18:28:20       WBI        7618.48             1       NOAA
   3: 2020-01-14 18:33:00       WBI        6958.89             1       NOAA
   4: 2020-01-14 18:33:00       WBI        6958.89             1       NOAA
   5: 2020-01-14 18:37:40       WBI        5685.43             1       NOAA
  ---                                                                      
5611: 2020-12-25 21:27:20       CAR        2138.78             1       NOAA
5612: 2020-12-25 21:33:00       CAR        1832.76             1       NOAA
5613: 2020-12-25 21:33:00       CAR        1832.76             1       NOAA
5614: 2020-12-25 21:35:40       CAR        1668.78             1       NOAA
5615: 2020-12-25 21:35:40       CAR        1668.78             1       NOAA
      dataset_calibration_scale  year month   day  hour minute second       time
                         &lt;char&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;  &lt;int&gt;      &lt;int&gt;
   1:            WMO CH4 X2004A  2020     1    14    18     28     20 1579026500
   2:             WMO CO2 X2019  2020     1    14    18     28     20 1579026500
   3:            WMO CH4 X2004A  2020     1    14    18     33      0 1579026780
   4:             WMO CO2 X2019  2020     1    14    18     33      0 1579026780
   5:            WMO CH4 X2004A  2020     1    14    18     37     40 1579027060
  ---                                                                           
5611:             WMO CO2 X2019  2020    12    25    21     27     20 1608931640
5612:            WMO CH4 X2004A  2020    12    25    21     33      0 1608931980
5613:             WMO CO2 X2019  2020    12    25    21     33      0 1608931980
5614:            WMO CH4 X2004A  2020    12    25    21     35     40 1608932140
5615:             WMO CO2 X2019  2020    12    25    21     35     40 1608932140
      time_decimal       value latitude longitude altitude_final elevation intake_height
             &lt;num&gt;       &lt;num&gt;    &lt;num&gt;     &lt;num&gt;          &lt;num&gt;     &lt;int&gt;         &lt;num&gt;
   1:     2020.038 1.91295e-06  41.7505  -91.0213        7618.48       242       7376.48
   2:     2020.038 4.13850e-04  41.7505  -91.0213        7618.48       242       7376.48
   3:     2020.038 1.92525e-06  41.7427  -91.1791        6958.89       234       6724.89
   4:     2020.038 4.14660e-04  41.7427  -91.1791        6958.89       234       6724.89
   5:     2020.038 1.92408e-06  41.7232  -91.3675        5685.43       236       5449.43
  ---                                                                                   
5611:     2020.983 4.15690e-04  40.7955 -104.6787        2138.78      1599        539.78
5612:     2020.983 1.93514e-06  40.6879 -104.6850        1832.76      1543        289.76
5613:     2020.983 4.15970e-04  40.6879 -104.6850        1832.76      1543        289.76
5614:     2020.983 2.00509e-06  40.7908 -104.6855        1668.78      1614         54.78
5615:     2020.983 4.18430e-04  40.7908 -104.6855        1668.78      1614         54.78
      gps_altitude pressure pressure_altitude      u      v temperature type_altitude
            &lt;lgcl&gt;   &lt;lgcl&gt;            &lt;lgcl&gt; &lt;lgcl&gt; &lt;lgcl&gt;      &lt;lgcl&gt;         &lt;int&gt;
   1:           NA       NA                NA     NA     NA          NA             1
   2:           NA       NA                NA     NA     NA          NA             1
   3:           NA       NA                NA     NA     NA          NA             1
   4:           NA       NA                NA     NA     NA          NA             1
   5:           NA       NA                NA     NA     NA          NA             1
  ---                                                                                
5611:           NA       NA                NA     NA     NA          NA             1
5612:           NA       NA                NA     NA     NA          NA             1
5613:           NA       NA                NA     NA     NA          NA             1
5614:           NA       NA                NA     NA     NA          NA             1
5615:           NA       NA                NA     NA     NA          NA             1
                  timeUTC          local_time    lh
                   &lt;POSc&gt;              &lt;POSc&gt; &lt;int&gt;
   1: 2020-01-14 18:28:20 2020-01-14 12:24:14    12
   2: 2020-01-14 18:28:20 2020-01-14 12:24:14    12
   3: 2020-01-14 18:33:00 2020-01-14 12:28:17    12
   4: 2020-01-14 18:33:00 2020-01-14 12:28:17    12
   5: 2020-01-14 18:37:40 2020-01-14 12:32:11    12
  ---                                              
5611: 2020-12-25 21:27:20 2020-12-25 14:28:37    14
5612: 2020-12-25 21:33:00 2020-12-25 14:34:15    14
5613: 2020-12-25 21:33:00 2020-12-25 14:34:15    14
5614: 2020-12-25 21:35:40 2020-12-25 14:36:55    14
5615: 2020-12-25 21:35:40 2020-12-25 14:36:55    14</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="receptors">Receptors<a class="anchor" aria-label="anchor" href="#receptors"></a>
</h2>
<p>Now we can do the last step which is generating the receptor list
files. Now we filter selected columns</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">receptor</span> <span class="op">&lt;-</span> <span class="va">master</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"site_code"</span>,</span>
<span>                       <span class="st">"year"</span>,</span>
<span>                       <span class="st">"month"</span>,</span>
<span>                       <span class="st">"day"</span>,</span>
<span>                       <span class="st">"hour"</span>,</span>
<span>                       <span class="st">"minute"</span>,</span>
<span>                       <span class="st">"second"</span>,</span>
<span>                       <span class="st">"latitude"</span>,</span>
<span>                       <span class="st">"longitude"</span>,</span>
<span>                       <span class="st">"altitude_final"</span>,</span>
<span>                       <span class="st">"type_altitude"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>We can round altitude also</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">receptor</span><span class="op">$</span><span class="va">altitude_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">receptor</span><span class="op">$</span><span class="va">altitude_final</span><span class="op">)</span></span></code></pre></div>
<p>Now we can format time variables with two digits</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">receptor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/obs_format.html">obs_format</a></span><span class="op">(</span><span class="va">receptor</span>,</span>
<span>                        spf <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"month"</span>, <span class="st">"day"</span>,</span>
<span>                                 <span class="st">"hour"</span>, <span class="st">"minute"</span>, <span class="st">"second"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We have a column that indicate AGL or ASL</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">receptor_agl</span> <span class="op">&lt;-</span> <span class="va">receptor</span><span class="op">[</span><span class="va">type_altitude</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span></span>
<span><span class="va">receptor_asl</span> <span class="op">&lt;-</span> <span class="va">receptor</span><span class="op">[</span><span class="va">type_altitude</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Finally, we save the receptors</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">receptor_agl</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">"_receptor_AGL.txt"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">receptor_agl</span>,</span>
<span>         file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">"_receptor_AGL.txt"</span><span class="op">)</span>,</span>
<span>         sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">receptor_asl</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">"_receptor_ASL.txt"</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/fwrite.html" class="external-link">fwrite</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">receptor_asl</span>,</span>
<span>         file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">out</span>, <span class="st">"_"</span>, <span class="va">datasetid</span>, <span class="st">"receptor_ASL.txt"</span><span class="op">)</span>,</span>
<span>         sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code>C:\Users\sibarrae\AppData\Local\Temp\RtmpAj3Z3p\file7f9c18b239ca_aircraft-pfp_receptor_ASL.txt</code></pre>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>Finally, we just plot some data, run it locally</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/obs_plot.html">obs_plot</a></span><span class="op">(</span><span class="va">df3</span><span class="op">[</span><span class="va">dataset_calibration_scale</span> <span class="op">==</span> <span class="st">"WMO CO2 X2019"</span><span class="op">]</span>,</span>
<span>         time <span class="op">=</span>  <span class="st">"timeUTC"</span>,</span>
<span>         yfactor <span class="op">=</span> <span class="fl">1e6</span><span class="op">)</span></span></code></pre></div>
<pre><code>Found the following sites: 
 [1] WBI THD TGC SGP SCA PFA NHA LEF HIL ETL ESP CMA CAR
Plotting the following sites: 
[1] WBI THD</code></pre>
<div class="float">
<img src="../reference/figures/obsplot_aircraftpfp.png" alt="Time series"><div class="figcaption">Time series</div>
</div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df3</span><span class="op">[</span><span class="va">dataset_calibration_scale</span> <span class="op">==</span> <span class="st">"WMO CO2 X2019"</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span><span class="op">*</span><span class="fl">1e+6</span><span class="op">)</span>,</span>
<span>         by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">site_code</span>,</span>
<span>                <span class="va">latitude</span>,</span>
<span>                <span class="va">longitude</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">st_as_sf</span><span class="op">(</span><span class="va">x</span>, </span>
<span>              coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>,</span>
<span>                         <span class="st">"latitude"</span><span class="op">)</span>, </span>
<span>              crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="st">"V1"</span><span class="op">]</span>, </span>
<span>     axes <span class="op">=</span> <span class="cn">T</span>, </span>
<span>     reset <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span><span class="fu">maps</span><span class="fu">::</span><span class="fu">map</span><span class="op">(</span>add <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/obsplot_aircraftpfp_map.png" alt="Map"><div class="figcaption">Map</div>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">df3</span><span class="op">[</span><span class="va">dataset_calibration_scale</span> <span class="op">==</span> <span class="st">"WMO CO2 X2019"</span><span class="op">]</span></span>
<span><span class="va">x</span><span class="op">$</span><span class="va">co2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">*</span><span class="fl">1e+6</span></span>
<span><span class="fu"><a href="../reference/obs_plot.html">obs_plot</a></span><span class="op">(</span><span class="va">x</span>, </span>
<span>         time <span class="op">=</span> <span class="st">"co2"</span>, </span>
<span>         y <span class="op">=</span> <span class="st">"altitude_final"</span>, </span>
<span>         colu <span class="op">=</span> <span class="st">"site_code"</span>, <span class="co">#n = c(1L, 3L, 6L, 8L, 9L, 11L, 12L), </span></span>
<span>         type <span class="op">=</span> <span class="st">"p"</span>, </span>
<span>         xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">CO</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">~</span><span class="va">ppm</span><span class="op">)</span>, </span>
<span>         ylab <span class="op">=</span> <span class="st">"altitude (m)"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="../reference/figures/obsplot_aircraftpfp_vert.png" alt="Vertical profiles"><div class="figcaption">Vertical profiles</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sergio Ibarra-Espinosa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
